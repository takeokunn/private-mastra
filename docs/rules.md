# コーディング規約

このドキュメントは、Mastra プロジェクトで使用されるコーディング規約を概説します。

## 全般

*   **言語:** TypeScript
*   **リンター/フォーマッター:** Biome (`biome.json`) - 設定されたルールに従ってください。
*   **テストフレームワーク:** Vitest (`vitest.config.ts`)

## ファイル構造

*   `src/mastra` ディレクトリ内で、機能/ドメインごとにコードを整理します（例: `agents`, `tools`）。
*   各機能ディレクトリには以下を含める必要があります:
    *   実装ファイル (`*.ts`)
    *   テストファイル (`*.spec.ts`)
    *   公開モジュールを再エクスポートするための `index.ts` ファイル。
*   ドキュメント (`docs`) は、該当する場合、`src` の構造を反映する必要があります。

## 命名規則

*   **ファイル:** ケバブケースを使用します（例: `weather-api.ts`）。
    *   テストファイル: `*.spec.ts` （例: `weather-api.spec.ts`）。
    *   インデックスファイル: `index.ts`。
*   **型/インターフェース:** パスカルケースを使用します（例: `WeatherResponse`, `AgentConfig`）。
*   **変数/関数/プロパティ:** キャメルケースを使用します（例: `fetchWeatherData`, `temperature`）。
    *   スネークケースを使用する外部 API を扱う場合、実用的な範囲で内部的にキャメルケースにマッピングします（例: `temperature_2m` を `temperature` にマッピング）。
*   **定数:** アッパースネークケースを使用します（例: `DEFAULT_TIMEOUT`）。

## TypeScript 固有事項

*   **型定義:** 宣言のマージのようなインターフェース固有の機能が必要でない限り、オブジェクトの形状や関数シグネチャを定義するには `type` エイリアスを優先します。
*   **エクスポート:** ディレクトリ内の `index.ts` ファイルを使用して、そのモジュールの明確な公開 API を提供します。`export *` を使用するのではなく、特定のメンバーをエクスポートします。
*   **インポート:** 標準の ES モジュール `import` ステートメントを使用します。Biome のルールに従ってインポートを整理します（通常はアルファベット順、グループ化）。
*   **関数定義:** 可能な限りアロー関数 (`=>`) を使用します。
*   **制御フロー:** ネストを減らすために早期リターン (early return) パターンを優先します。

## テスト

*   テストファイル (`*.spec.ts`) を、テスト対象のソースファイルと同じ場所に配置します。
*   主要なユースケース、エッジケース、エラーハンドリングをカバーする、明確で簡潔なテストを作成します。

## ドキュメンテーションとコメント

*   ドキュメントは Markdown (`.md`) で記述します。
*   ドキュメントは `docs` ディレクトリに、ソース構造を反映させて保存します。
*   公開 API（関数、型、クラス）は TSDoc コメントを使用して文書化します。
*   **コードコメント:** コードの意図や複雑なロジックを説明する必要がある場合は、日本語でコメントを記述します。
